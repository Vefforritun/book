<!DOCTYPE html>
<!--
  Velkominn ferðalangur, bakvið tjöldin, í uppsprettuna.
  Þetta HTML er sjálfkrafa útbúið út frá Markdown skjölum.
  Sjá nánar:
  https://github.com/vefforritun/book
  -->
<html lang="is">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Vefforitun—Kafli 16: Kvikun</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="reset.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main>
      <header>
        <h1>Kafli 16: Kvikun</h1>
        <div class="reading-time">Um 6 mín lestur</div>
      </header>

      <article>
        <div class="paragraphs">
          <p>
            Kvikun (e. animation) er þegar við látum eitthvað hreyfast eftir
            ákveðnum reglum. Í CSS er hægt að gera það með
            <code>transition</code> og <code>animation</code> eigindunum. Með
            því að nota hreyfingar getum við gert viðmót eðlilegra, vinalegra og
            skemmtilegra. Viðmót geta orðið fágaðari, þar sem við fjarlægjum
            „grófleikann“ sem getur orðið ef við breytum einhverju samstundis.
            Of mikið af hreyfingum er þó ekki eitthvað sem við viljum, það þarf
            ekki <em>allt</em> að hreyfast <em>alltaf</em>.
          </p>
        </div>
        <h2 id="16.1">
          <span>
            <a href="#16.1">16.1</a>
          </span>
          Umskipti
        </h2>
        <div class="paragraphs">
          <p>
            Með umskiptum (e. transition) látum við eitt gildi breytast í annað
            á skilgreindum tíma. Breytingin gerist ekki strax, það er einhver
            brúun á milli upphafs og endagildis. Við skilgreinum hvaða eigindi
            eigi að breyta, á hve löngum tíma og með hvaða hröðun. Vafrinn sér
            síðan um að brúa gildið m.v. það sem við&nbsp;viljum.
          </p>
          <p>
            Umskipti virka þannig að vafri fylgist með gildi og ef við
            skilgreinum að það breytist (t.d. ef við setjum nýtt gildi með
            <code>:hover</code>) þá er gildinu ekki breytt samstundis.
            <code>transition</code> er shorthand&nbsp;fyrir:
          </p>
        </div>
        <ul>
          <li>
            <code>transition-property</code>, hvaða eigindi eigi
            að&nbsp;umskipta.
          </li>
          <li>
            <code>transition-duration</code>, hve lengi umskipti eigi
            að&nbsp;taka.
          </li>
          <li>
            <code>transition-timing-function</code>, hröðunar
            fall&nbsp;umskipta.
          </li>
          <li>
            <code>transition-delay</code>, hve lengi skuli bíða
            með&nbsp;umskipti.
          </li>
        </ul>

        <div class="code code-css">
          <table class="code-table">
            <tr>
              <td class="line-number" data-pseudo-content="1"></td>
              <td>
                <pre><span class="hljs-comment">/* transition: &lt;property&gt; &lt;duration&gt; &lt;timing-function&gt; &lt;delay&gt; */</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="2"></td>
              <td>
                <pre><span class="hljs-comment">/* color gildi mun breytast með línulegri hröðun á 250 millisek */</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="3"></td>
              <td>
                <pre><span class="hljs-selector-tag">transition</span>: <span class="hljs-selector-tag">color</span> 250<span class="hljs-selector-tag">ms</span> <span class="hljs-selector-tag">linear</span> 0;</pre>
              </td>
            </tr>
          </table>
        </div>
        <div class="paragraphs">
          <p>
            Hægt er að skilgreina fleiri en eitt umskipti með því að skipta á
            kommu, <code>,</code>:
          </p>
        </div>
        <div class="code code-css">
          <table class="code-table">
            <tr>
              <td class="line-number" data-pseudo-content="1"></td>
              <td>
                <pre>transition: color 250ms, background-color 250ms;</pre>
              </td>
            </tr>
          </table>
        </div>
        <div class="paragraphs">
          <p>
            Með <code>transition-property</code> skilgreinum við með hvaða
            eigindi við fylgjumst. Það er leyfilegt að setja
            <code>all</code> sem gildi en þá er fylgst með breytingum
            <em>á&nbsp;öllum</em> eigindum og getur það valdið óþarfa hægagangi.
            Við viljum vera nákvæm í því hvað á að breytast og forðumst það því.
            Tíma er hægt að skilgreina í millisekúndum&nbsp;(<code>250ms</code>)
            eða sekúndum&nbsp;(<code>1.25s</code>).
          </p>
        </div>
        <div class="code code-css">
          <table class="code-table">
            <tr>
              <td class="line-number" data-pseudo-content="1"></td>
              <td>
                <pre><span class="hljs-selector-tag">a</span> {</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="2"></td>
              <td>
                <pre>  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#000</span>;</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="3"></td>
              <td>
                <pre>  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="4"></td>
              <td><pre></pre></td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="5"></td>
              <td>
                <pre>  <span class="hljs-comment">/*</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="6"></td>
              <td>
                <pre><span class="hljs-comment">  í staðinn fyrir að skipta beint úr svörtu í hvítt gerum</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="7"></td>
              <td>
                <pre><span class="hljs-comment">  við það á 250ms svo það verður ekkert „blikk“</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="8"></td>
              <td>
                <pre><span class="hljs-comment">  */</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="9"></td>
              <td>
                <pre>  <span class="hljs-attribute">transition</span>: color <span class="hljs-number">250ms</span>, background-color <span class="hljs-number">250ms</span>;</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="10"></td>
              <td><pre>}</pre></td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="11"></td>
              <td><pre></pre></td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="12"></td>
              <td>
                <pre><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span> {</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="13"></td>
              <td>
                <pre>  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="14"></td>
              <td>
                <pre>  <span class="hljs-attribute">color</span>: <span class="hljs-number">#000</span>;</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="15"></td>
              <td><pre>}</pre></td>
            </tr>
          </table>
        </div>

        <h3 id="16.1.1">
          <span>
            <a href="#16.1.1">16.1.1</a>
          </span>
          Hröðun
        </h3>
        <div class="paragraphs">
          <p>
            Hröðunarfall er skilgreint með
            <em>rúmfræðilegri bezier&nbsp;kúrvu</em> (e. cubic bezier curve) eða
            lykilorði (sem er tengt við ákveðna bezier&nbsp;kúrvu).
          </p>

          <figure>
            <div class="image small">
              <div class="img">
                <img
                  alt=""
                  src="img/cubic-bezier.png"
                  width="289"
                  height="332"
                  loading="lazy"
                />
              </div>
              <div class="ratio" style="padding-top: 114.878893%"></div>
            </div>

            <figcaption>
              <p>Dæmi um bezier kúrvu.</p>
              <footer>
                Mynd frá MDN:
                <a
                  href="https://developer.mozilla.org/en-US/docs/Web/CSS/easing-function"
                  >https://developer.mozilla.org/en-US/docs/Web/CSS/easing-function</a
                >
              </footer>
            </figcaption>
          </figure>
          <p>
            Bezier kúrvur eru föll sem skilgreina hvernig gildi breytist yfir
            tíma: hver hröðun þess er. Ef við höfum línulega hröðun fer gildið
            frá upphafsgildi til lokagildis með nákvæmlega sama hlutfalli á
            hverja tímaeiningu. <code>cubic-bezier(x1, y1, x2, y2)</code> er
            fall í CSS sem leyfir okkur að skilgreina nákvæmlega hvernig kúrvan
            hagar sér en við notum yfirleitt lykilorð sem skilgreina mikið
            notaðar&nbsp;kúrvur.
          </p>
        </div>
        <ul>
          <li><code>linear</code>, hröðun er&nbsp;línuleg.</li>
          <li>
            <code>ease</code>, sjálfgefið gildi fyrir þau eigindi sem nota
            hröðun, mikil hröðun í byrjun, hægir síðan á sér og kemur rólega
            í&nbsp;mark.
          </li>
          <li>
            <code>ease-in</code>, byrjar hægt en eykur hröðun eftir því sem
            endi&nbsp;nálgast.
          </li>
          <li>
            <code>ease-in-out</code>, byrjar hægt, eykur hraða en hægir aftur á
            sér þegar endi&nbsp;nálgast.
          </li>
          <li>
            <code>ease-out</code>, byrjar hratt en hægir á sér þegar
            endi&nbsp;nálgast.
          </li>
        </ul>
        <div class="paragraphs">
          <figure>
            <div class="image small">
              <div class="img">
                <img
                  alt=""
                  src="img/cubic-bezier-linear.png"
                  width="249"
                  height="332"
                  loading="lazy"
                />
              </div>
              <div class="ratio" style="padding-top: 133.333333%"></div>
            </div>

            <figcaption>
              <p>Línuleg hröðun með linear lykilorði.</p>
              <footer>
                Mynd frá MDN:
                <a
                  href="https://developer.mozilla.org/en-US/docs/Web/CSS/easing-function"
                  >https://developer.mozilla.org/en-US/docs/Web/CSS/easing-function</a
                >
              </footer>
            </figcaption>
          </figure>

          <figure>
            <div class="image small">
              <div class="img">
                <img
                  alt=""
                  src="img/cubic-bezier-ease-in-out.png"
                  width="244"
                  height="332"
                  loading="lazy"
                />
              </div>
              <div class="ratio" style="padding-top: 136.065574%"></div>
            </div>

            <figcaption>
              <p>Hröðun með ease-in-out lykilorði.</p>
              <footer>
                Mynd frá MDN:
                <a
                  href="https://developer.mozilla.org/en-US/docs/Web/CSS/easing-function"
                  >https://developer.mozilla.org/en-US/docs/Web/CSS/easing-function</a
                >
              </footer>
            </figcaption>
          </figure>
        </div>
        <h2 id="16.2">
          <span>
            <a href="#16.2">16.2</a>
          </span>
          Animation
        </h2>
        <div class="paragraphs">
          <p>
            Með <code>animation</code> eigindinu getum við útbúið flóknari
            hreyfingar án þess að nota JavaScript. Við skilgreinum
            <em>keyframes</em> fyrir hreyfinguna með
            <code>@keyframes</code> at-reglunni. Hreiðraðar skipanir innan
            <code>@keyframes</code> hafa ekki selector heldur prósentugildi eða,
            lykilorðin <code>from</code> sem er jafngilt <code>0%</code> eða
            <code>to</code> sem er jafngilt <code>100%</code>. Gildin segja til
            um hvernig hreyfing lítur út á viðeigandi stað og mun vafri brúa á
            milli m.v. gefinn tíma og&nbsp;hröðun.
          </p>
        </div>
        <div class="code code-css">
          <table class="code-table">
            <tr>
              <td class="line-number" data-pseudo-content="1"></td>
              <td>
                <pre><span class="hljs-keyword">@keyframes</span> fade {</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="2"></td>
              <td>
                <pre>  <span class="hljs-comment">/* þegar hreyfing er í 0% er opacity: 0 */</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="3"></td>
              <td>
                <pre>  <span class="hljs-selector-tag">from</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="4"></td>
              <td><pre></pre></td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="5"></td>
              <td>
                <pre>  <span class="hljs-comment">/* þegar hreyfing er í 50% er opacity: 0.4 */</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="6"></td>
              <td>
                <pre>  50% { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.4</span>; }</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="7"></td>
              <td><pre></pre></td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="8"></td>
              <td>
                <pre>  <span class="hljs-comment">/* þegar hreyfing er í 100% er opacity: 1 */</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="9"></td>
              <td>
                <pre>  <span class="hljs-selector-tag">to</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; }</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="10"></td>
              <td><pre>}</pre></td>
            </tr>
          </table>
        </div>
        <div class="paragraphs">
          <p>
            Við stýrum síðan hvernig hreyfing hagar sér með
            <code>animation</code> sem er shorthand&nbsp;fyrir:
          </p>
        </div>
        <ul>
          <li>
            <code>animation-name</code>, nafnið á hreyfingu skilgreindu með
            <code>@keyframes</code>
          </li>
          <li>
            <code>animation-duration</code>, hversu langan tíma hreyfing eigi
            að&nbsp;taka
          </li>
          <li><code>animation-timing-function</code>,&nbsp;hröðunarfall</li>
          <li>
            <code>animation-delay</code>, hversu lengi eigi að bíða með að
            byrja&nbsp;hreyfingu
          </li>
          <li>
            <code>animation-iteration-count</code>, hversu oft á að keyra
            hreyfingu, tala sem sjálfgefið er <code>1</code>, getur líka tekið
            gildið <code>infinite</code>
          </li>
          <li>
            <code>animtaion-fill-mode</code>, hvernig á að tækla eigindi sem
            aðeins eru sett í hreyfingu eftir og áður en hún&nbsp;keyrir?
          </li>
          <li>
            <code>animation-play-state</code>, í hvaða stöðu er hreyfing,
            sjálfgefið <code>running</code> en getur líka verið
            <code>paused</code>
          </li>
          <li>
            <code>animation-direction</code>, í hvaða átt á að
            keyra&nbsp;hreyfingu
          </li>
        </ul>
        <div class="paragraphs">
          <p>
            Fyrir <code>animation-direction</code> getum við
            notað&nbsp;lykilorðin:
          </p>
        </div>
        <ul>
          <li>
            <code>normal</code>, sjálfgefið, keyrð <em>áfram</em> og þegar hún
            klárast byrjað aftur frá&nbsp;byrjun
          </li>
          <li>
            <code>reverse</code>, keyrð <em>afturábak</em> og byrjað á enda
            þegar hún&nbsp;klárast
          </li>
          <li>
            <code>alternate</code>, keyrð áfram og afturábak til&nbsp;skiptis
          </li>
          <li>
            <code>alternate-reverse</code>, keyrð afturábak og áfram
            til&nbsp;skiptis
          </li>
        </ul>

        <div class="code code-css">
          <table class="code-table">
            <tr>
              <td class="line-number" data-pseudo-content="1"></td>
              <td>
                <pre><span class="hljs-comment">/*</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="2"></td>
              <td>
                <pre><span class="hljs-comment">animation: duration | timing-function | delay |  iteration-count |</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="3"></td>
              <td>
                <pre><span class="hljs-comment">           direction | fill-mode | play-state | name </span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="4"></td>
              <td>
                <pre><span class="hljs-comment">*/</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="5"></td>
              <td>
                <pre><span class="hljs-selector-tag">animation</span>: 2<span class="hljs-selector-tag">s</span> <span class="hljs-selector-tag">ease</span> 0 <span class="hljs-selector-tag">infinite</span> <span class="hljs-selector-tag">alternate</span> <span class="hljs-selector-tag">both</span> <span class="hljs-selector-tag">running</span> <span class="hljs-selector-tag">fade</span>;</pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="6"></td>
              <td><pre></pre></td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="7"></td>
              <td>
                <pre><span class="hljs-comment">/* animation: duration | name */</span></pre>
              </td>
            </tr>
            <tr>
              <td class="line-number" data-pseudo-content="8"></td>
              <td>
                <pre><span class="hljs-selector-tag">animation</span>: 3<span class="hljs-selector-tag">s</span> <span class="hljs-selector-tag">fade</span>;</pre>
              </td>
            </tr>
          </table>
        </div>

        <h2 id="16.3">
          <span>
            <a href="#16.3">16.3</a>
          </span>
          Transform
        </h2>
        <div class="paragraphs">
          <p>
            Með <code>transform</code> eigindinu getum við gert breytingar á
            tvívíðu og þrívíðu rúmi hluta með því að nota
            <code>translate</code>, <code>rotate</code>, <code>skew</code> og
            <code>scale</code>. Lang flestar af þessum aðgerðum verða fluttar af
            vafra frá <em>CPU</em> yfir á <em>GPU</em> (graphics processing
            unit, sérstakur kubbur í tölvu sérhannaður til að vinna með grafík)
            og eru þessar aðgerir því <strong>miklu</strong> hagkvæmari en að
            reikna út gildi og teikna allt útlit vefs aftur ef við myndum t.d.
            nota <code>position</code>.
          </p>
          <p>
            Ef við viljum færa hlut notum við
            <code>transform: translate(x, y)</code> til að færa á x og y-ás.
            Getum einnig gert í þrívíðu rúmi með
            <code>transform: translate3d(x, y, z)</code>.
          </p>
          <p>
            Ef við viljum stækka eða minnka hlut notum við
            <code>transform: scale(ratio);</code> þar sem <code>ratio</code> er
            hlutfall, <code>1.0</code> og hlutur er í venjulegri stærð (m.v.
            teiknað útlit), <code>0.5</code> og hann er helmingi minni,
            <code>2.0</code> og hann er tvisvar sinnum&nbsp;stærri.
          </p>
        </div>
        <h2 id="16.4">
          <span>
            <a href="#16.4">16.4</a>
          </span>
          Sjónarhorn
        </h2>
        <div class="paragraphs">
          <p>
            Þegar við gerum breytingar í þrívíðu rúmi þurfum við að skilgreina
            hversu langt frá notanda núllpunktur z-áss er, hver sjónarhorn (e.
            perspective) okkar er. Það gerum við með
            <code>perspective</code> eigindinu. Sjálfgefna gildið er
            <code>none</code> sem þýðir að fjarlægð frá z-ás er óskilgreind og
            allar þrívíðar breytingar munu ekki&nbsp;sjást.
          </p>
        </div>
        <h2 id="16.5">
          <span>
            <a href="#16.5">16.5</a>
          </span>
          Jank
        </h2>
        <div class="paragraphs">
          <p>
            Þegar við erum að vinna með hreyfingar viljum við halda þeim mjúkum
            og fínum, án þess að þær haltri eða líti skringilega út. Galdratalan
            í því samhengi eru 60fps eða 60 rammar á sekúndu. Það þýðir að hver
            vafrinn (eða það sem er að birta hreyfingu) hefur 16,67 millisekúndu
            per ramma til að gera alla þá útreikninga sem þarf til að láta næsta
            ramma birtast rétt. Ef við erum að gera of mikið á þessum tíma, t.d.
            hreyfa of marga hluti eða á óhagkvæman máta, þá förum við að taka
            eftir <em>jank</em>, hlutir hreyfast&nbsp;óeðlilega.
          </p>

          <figure>
            <div class="image">
              <div class="iframe">
                <iframe
                  src="https://www.youtube.com/embed/-62uPWUxgcg"
                  frameborder="0"
                  allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                  allowfullscreen
                ></iframe>
                <div class="ratio" style="padding-top: 56.25%"></div>
              </div>
            </div>

            <figcaption>
              <p>Dæmi um jank í vefviðmóti., vídeó á YouTube.</p>
              <footer>Mynd frá YouTube</footer>
            </figcaption>
          </figure>
          <p>
            TIl að komast hjá jank þegar við búum til hreyfingar er ein einföld
            regla sem kemur okkur vel áleiðis:
            <strong
              >aðeins breyta <code>opacity</code> og
              <code>transform</code> þegar við hreyfum&nbsp;hluti</strong
            >. Að breyta öðrum eigindum mun valda því að GPU er ekki&nbsp;notað.
          </p>
          <p>
            Einnig getum við notað <code>will-change</code> eigindið sem lætur
            vafra vita að við munum breyta ákveðnum eigindi og er þá hægt að
            gera viðeigandi ráðstafanir. Listin að gera vefi sem eru hraðir og
            nýta hagkvæmar leiðir er mikil list, hægt er að læra meira á
            <a href="http://jankfree.org/">Jank&nbsp;Free</a>.
          </p>
        </div>
      </article>

      <footer>
        <nav>
          <ul>
            <li class="prev">
              <p><a href="./15.skalanlegir.html">Skalanlegir&nbsp;vefir</a></p>
            </li>
            <li class="index"><a href="/">Efnisyfirlit</a></li>
            <li class="next">
              <p><a href="./17.honnun.html">Hönnun</a></p>
            </li>
          </ul>
        </nav>
        <hr />
        <div class="version">Útgáfa 0.3, september 2020</div>
      </footer>
    </main>
  </body>
</html>
